## RF-DETR Pretrained Weights

The RF-DETR model weights (~122 MB) are available as a GitHub Release asset. You can download them directly here:

[üîó rf_detr_803.pt (122 MB)](https://github.com/vkalinovski/-Basketball_foul_detection/releases/download/RF-DETR_WEIGHTS/rf_detr_803.pt)

# RF-DETR: –û–±—É—á–µ–Ω–∏–µ –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è –≤–∏–¥–µ–æ

–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π **RF-DETR** ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –Ω–∞ –æ—Å–Ω–æ–≤–µ Transformer –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –≤–∏–¥–µ–æ c –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–¥–∏–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

    ‚îú‚îÄ‚îÄ rf-detr-train.ipynb        # –ù–æ—É—Ç–±—É–∫ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ RF-DETR
    ‚îú‚îÄ‚îÄ video_annotation.ipynb     # –ù–æ—É—Ç–±—É–∫ –¥–ª—è —Ä–∞–∑–º–µ—Ç–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ
    ‚îú‚îÄ‚îÄ configs/                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    ‚îÇ   ‚îú‚îÄ‚îÄ default.yaml           # –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è
    ‚îÇ   ‚îî‚îÄ‚îÄ radar_features.yaml    # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞–¥–∏–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    ‚îú‚îÄ‚îÄ data/                      # –ò—Å—Ö–æ–¥–Ω—ã–µ –≤–∏–¥–µ–æ –∏ —Ä–∞–∑–º–µ—Ç–∫–∞
    ‚îÇ   ‚îú‚îÄ‚îÄ raw/                   # –°—ã—Ä—ã–µ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—ã (.mp4, .avi ‚Ä¶)
    ‚îÇ   ‚îî‚îÄ‚îÄ labels/                # –†–∞–∑–º–µ—á–µ–Ω–Ω—ã–µ –∫–∞–¥—Ä—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ COCO (.json)
    ‚îú‚îÄ‚îÄ outputs/                   # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è –∏ –≤—ã–≤–æ–¥–∞ –º–æ–¥–µ–ª–µ–π
    ‚îÇ   ‚îú‚îÄ‚îÄ checkpoints/           # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ (.pth)
    ‚îÇ   ‚îî‚îÄ‚îÄ annotated_videos/      # –í–∏–¥–µ–æ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ (.mp4)
    ‚îî‚îÄ‚îÄ README.md                  # –≠—Ç–æ—Ç —Ñ–∞–π–ª

---

## üß† –ú–æ–¥–µ–ª—å: RF-DETR

**RF-DETR (Radar Frequency Detection Transformer)** –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å–≤—ë—Ä—Ç–æ—á–Ω—ã–µ —Å–µ—Ç–∏ –∏ Transformer –¥–ª—è:

- **–í—ã—Å–æ–∫–æ—Ç–æ—á–Ω–æ–π –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏** –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∏–¥–µ–æ–∫–∞–¥—Ä–∞—Ö  
- **–°—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —Ç—Ä–µ–∫–∏–Ω–≥–∞** –ø—Ä–∏ –Ω–∏–∑–∫–æ–º –∫–∞—á–µ—Å—Ç–≤–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è  
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ä–∞–¥–∏–æ—á–∞—Å—Ç–æ—Ç–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏  

–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –Ω–∞ **PyTorch** —Å **Detectron2**. –î–æ—Å—Ç—É–ø–Ω—ã backbone-—ã *ResNet-50* –∏ *ResNet-101*.

---

## üöÄ –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (`rf-detr-train.ipynb`)

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö**  
   ‚Ä¢ –ò–º–ø–æ—Ä—Ç –≤–∏–¥–µ–æ –∏–∑ `data/raw/`  
   ‚Ä¢ –≠–∫—Å–ø–æ—Ä—Ç –∫–ª—é—á–µ–≤—ã—Ö –∫–∞–¥—Ä–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π COCO ‚Üí `data/labels/`  

2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**  
   ‚Ä¢ –ü—É—Ç–∏ –∫ –¥–∞–Ω–Ω—ã–º, `batch_size`, `learning_rate`, —á–∏—Å–ª–æ —ç–ø–æ—Ö  
   ‚Ä¢ –í—ã–±–æ—Ä backbone –∏ —Ä–∞–¥–∏–æ—á–∞—Å—Ç–æ—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞  

3. **–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞**  
   ‚Ä¢ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è RF-DETR  
   ‚Ä¢ –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤ –≤ `outputs/checkpoints/`  
   ‚Ä¢ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ *loss* –∏ *mAP*  

4. **–í–∞–ª–∏–¥–∞—Ü–∏—è**  
   ‚Ä¢ –ó–∞–ø—É—Å–∫ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ  
   ‚Ä¢ –ú–µ—Ç—Ä–∏–∫–∏ `mAP`, `AR`, –≤—Ä–µ–º—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞  

---

## üé• –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è –≤–∏–¥–µ–æ (`video_annotation.ipynb`)

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏**  
   ‚Ä¢ –ß–µ–∫–ø–æ–∏–Ω—Ç: `outputs/checkpoints/latest.pth`  

2. **–ü—Ä–æ—Ü–µ—Å—Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏**  
   ‚Ä¢ –ö–∞–¥—Ä–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ –∏–∑ `data/raw/`  
   ‚Ä¢ –î–µ—Ç–µ–∫—Ü–∏—è –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ç–∫–∏ (COCO –∏–ª–∏ YOLO)  

3. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**  
   ‚Ä¢ Bounding-boxes, –º–µ—Ç–∫–∏, confidence-score  
   ‚Ä¢ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ID —Ç—Ä–µ–∫–∏–Ω–≥–∞  
   ‚Ä¢ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∏–¥–µ–æ –≤ `outputs/annotated_videos/`  

4. **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**  

        from video_annotation import annotate_video

        annotate_video(
            model_path='outputs/checkpoints/latest.pth',
            input_video='data/raw/sample.mp4',
            output_video='outputs/annotated_videos/sample_annotated.mp4',
            annotation_format='coco',
            show_tracking_ids=True
        )
